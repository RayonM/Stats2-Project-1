---
title: "Stats2 Project1"
author: "Rayon M"
date: "1/30/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Libraries

library("tidyverse")
library("ggplot2")
library("GGally")
library("naniar")


```

```{r}
# Get working directory
# getwd()

```

```{r}
# Create dataframe
AutoM <- read.csv("data1.csv")

view(AutoM)
head(AutoM)

#sum of missing values
sum(is.na(AutoM))

#count total missing values in each column of data frame
sapply(AutoM, function(x) sum(is.na(x)))

# rename variables for easier control.
new_AutoM <- AutoM %>% rename(Fuel_Type = Engine.Fuel.Type, HorsePower = Engine.HP, Cylinders = Engine.Cylinders, Transmission = Transmission.Type, Doors = Number.of.Doors, Market_Category = Market.Category, Vehicle_Size = Vehicle.Size, Vehicle_Style = Vehicle.Style, Highway_MPG = highway.MPG, City_MPG = city.mpg )

new_AutoM

# Function that shows the percentage of missing data
vis_miss(new_AutoM)


```


```{r}
# Create categorical variables within the data

new_AutoM$Make <- as.factor(new_AutoM$Make)
new_AutoM$Model <- as.factor(new_AutoM$Model)
new_AutoM$Fuel_Type <- as.factor(new_AutoM$Fuel_Type)
new_AutoM$Transmission <- as.factor(new_AutoM$Transmission)
new_AutoM$Market_Category <- as.factor(new_AutoM$Market_Category)
new_AutoM$Vehicle_Size <- as.factor(new_AutoM$Vehicle_Size)
new_AutoM$Vehicle_Style <- as.factor(new_AutoM$Vehicle_Style)
new_AutoM$Cylinders <- as.factor(new_AutoM$Cylinders)
new_AutoM$Doors <- as.factor(new_AutoM$Doors)
new_AutoM$Driven_Wheels <- as.factor(new_AutoM$Driven_Wheels)


```


```{r}

#ggpairs(AutoM, columns = 3:8)

new_AutoM %>% 
  select (MSRP, Year, HorsePower, Cylinders, Driven_Wheels, Doors, Highway_MPG, City_MPG) %>%
  ggpairs(mapping = aes())

```

```{r}
summary(new_AutoM)

```
```{r}
t(aggregate(MSRP~Cylinders, data = new_AutoM, summary))
```


```{r}
# Plotting the explanatory variables versus the response variable

par(mfrow=c(1,3))
plot(horsepower,mpg, xlab="horsepower",ylab="mpg")
new<-data.frame(horsepower=seq(30,300,.1))
lines(seq(30,300,.1),predict(lm(mpg~horsepower),newdata=new),col="red",lwd=4)

plot(as.factor(cylinders), mpg,xlab="cylinders",ylab="mpg",title="Auto Data Set",col=c(7,32,57,82,107))

plot(weight,mpg)
new2<-data.frame(weight=seq(1600,5200,1))
lines(seq(1600,5200,1),predict(lm(mpg~weight),newdata=new2),col="red",lwd=4)



```

