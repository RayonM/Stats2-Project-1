---
title: "Stats2 Project1"
author: "Rayon M"
date: "1/30/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Libraries

library("tidyverse")
library("ggplot2")
library("GGally")
library("naniar")


```

```{r}
# Get working directory
# getwd()

```

```{r}
# Create dataframe
AutoM <- read.csv("data1.csv")

view(AutoM)
head(AutoM)

#sum of missing values
sum(is.na(AutoM))

#count total missing values in each column of data frame
sapply(AutoM, function(x) sum(is.na(x)))

# rename variables for easier control.
new_AutoM <- AutoM %>% rename(Fuel_Type = Engine.Fuel.Type, HorsePower = Engine.HP, Cylinders = Engine.Cylinders, Transmission = Transmission.Type, Doors = Number.of.Doors, Market_Category = Market.Category, Vehicle_Size = Vehicle.Size, Vehicle_Style = Vehicle.Style, Highway_MPG = highway.MPG, City_MPG = city.mpg )

new_AutoM

# Function that shows the percentage of missing data
vis_miss(new_AutoM)


```


```{r}
# Create categorical variables within the data

new_AutoM$Make <- as.factor(new_AutoM$Make)
new_AutoM$Model <- as.factor(new_AutoM$Model)
new_AutoM$Fuel_Type <- as.factor(new_AutoM$Fuel_Type)
new_AutoM$Transmission <- as.factor(new_AutoM$Transmission)
new_AutoM$Market_Category <- as.factor(new_AutoM$Market_Category)
new_AutoM$Vehicle_Size <- as.factor(new_AutoM$Vehicle_Size)
new_AutoM$Vehicle_Style <- as.factor(new_AutoM$Vehicle_Style)
new_AutoM$Cylinders <- as.factor(new_AutoM$Cylinders)
new_AutoM$Doors <- as.factor(new_AutoM$Doors)
new_AutoM$Driven_Wheels <- as.factor(new_AutoM$Driven_Wheels)


```


```{r}

#ggpairs(AutoM, columns = 3:8)

new_AutoM %>% 
  select (MSRP, Year, HorsePower, Cylinders, Driven_Wheels, Doors, Highway_MPG, City_MPG) %>%
  ggpairs(mapping = aes())

```

```{r}
summary(new_AutoM)

```
```{r}
t(aggregate(MSRP~Cylinders, data = new_AutoM, summary))
```


```{r}
# Plotting the explanatory variables versus the response variable

par(mfrow=c(1,3))
plot(horsepower,mpg, xlab="horsepower",ylab="mpg")
new<-data.frame(horsepower=seq(30,300,.1))
lines(seq(30,300,.1),predict(lm(mpg~horsepower),newdata=new),col="red",lwd=4)

plot(as.factor(cylinders), mpg,xlab="cylinders",ylab="mpg",title="Auto Data Set",col=c(7,32,57,82,107))

plot(weight,mpg)
new2<-data.frame(weight=seq(1600,5200,1))
lines(seq(1600,5200,1),predict(lm(mpg~weight),newdata=new2),col="red",lwd=4)



```



```{r}
 # $ Make             : Factor w/ 48 levels
 # $ Model            : Factor w/ 915 levels
 # $ Year             : int
 # $ Engine.Fuel.Type : Factor w/ 11 levels
 # $ Engine.HP        : num
 # $ Engine.Cylinders : num
 # $ Transmission.Type: Factor w/ 4 levels
 # $ Driven_Wheels    : Factor w/ 4 levels 
 # $ Number.of.Doors  : num
 # $ Market.Category  : Factor w/ 72 levels
 # $ Vehicle.Size     : Factor w/ 3 levels
 # $ Vehicle.Style    : Factor w/ 16 levels
 # $ highway.MPG      : num
 # $ city.mpg         : int
 # $ Popularity       : int
 # $ MSRP             : int  

# Make Categorical Variable Summary
t(aggregate(MSRP~Make,data=car_data,summary))


```

```{r}
# Model Categorical Variable Summary
t(aggregate(MSRP~Model,data=car_data,summary))
```

```{r}
# Engine Fuel Type Categorical Variable Summary
t(aggregate(MSRP~Engine.Fuel.Type,data=car_data,summary))
```

```{r}
# Transmission Type Categorical Variable Summary
t(aggregate(MSRP~Transmission.Type,data=car_data,summary))

```

```{r}
# Driven_Wheels Categorical Variable Summary
t(aggregate(MSRP~Driven_Wheels,data=car_data,summary))

```

```{r}
# Market Category Categorical Variable Summary
t(aggregate(MSRP~Market.Category,data=car_data,summary))
```

```{r}
# Vehicle Size Categorical Variable Summary
t(aggregate(MSRP~Vehicle.Size,data=car_data,summary))
```

```{r}
# Vehicle Style Categorical Variable Summary
t(aggregate(MSRP~Vehicle.Style,data=car_data,summary))
```




```{r}

# I think we should convert Engine.Cylinders to a factor. If we do so, we see that the data set only has 3 records with 16 Cylinders. We may need to remove them when performing Cross Validation, etc.
Auto <- car_data

Auto$Engine.Cylinders <- as.factor(Auto$Engine.Cylinders)

summary(Auto)
attach(Auto)
```

# EDA Categorical
```{r}

# Plot Make with MSRP to see the distribution.
plot(Make,MSRP, xlab="Make",ylab="MSRP")
# Observed that the Make - Bugatti was higher than the other Makes. Also observed a few outliers for other vehicles. Interesting note is that if we remove the 16 cylinder vehicles it removes all the Bugattis.

# Plot Model to see its distribution against MSRP.
plot(Model,MSRP, xlab="Make",ylab="MSRP") # Observed Trends probably hold on including in the model.

# Plot Engine.Fuel.Type with MSRP to see the distribution.
plot(Engine.Fuel.Type,MSRP, xlab="Engine Fuel Type",ylab="MSRP") # Possibly correlated with Make


# Plot Engine.Cylinders with MSRP to see the distribution.
plot(Engine.Cylinders,MSRP, xlab="Engine Cylinders",ylab="MSRP") # Nice gradual increasing Trend. Will add to the model.

# Plot Transmission Type with MSRP to see the distribution.
plot(Transmission.Type,MSRP, xlab="Transmission Type",ylab="MSRP") # Slight descrease in the means. Automated Manual had the outliers. Interesting enough those were the Bugattis.


# Plot Driven Wheels with MSRP to see the distribution.
plot(Driven_Wheels,MSRP, xlab="Wheels",ylab="MSRP") # Slight descrease in the means. Automated Manual had the outliers. Interesting enough those were the Bugattis.

# Plot Market Category with MSRP to see the distribution.
plot(Market.Category,MSRP, xlab="Market Category",ylab="MSRP") # One to watch. Would start without it. However, I could see a potential for it to be included.


# Plot Vehicle Size with MSRP to see the distribution.
plot(Vehicle.Size,MSRP, xlab="Vehicle Size",ylab="MSRP") # Couple outliers: Buggati and the MayBach. Otherwise Means are pretty even.


# Plot Vehicle Style with MSRP to see the distribution.
plot(Vehicle.Style,MSRP, xlab="Vehicle Style",ylab="MSRP") # Couple outliers: Buggati and the MayBach. Otherwise Means are pretty even.



```


# EDA Numerical

```{r}
# Year
plot(Year,MSRP, xlab="Year",ylab="MSRP")
new<-data.frame(Year=seq(1990,2020,1))
lines(seq(1990,2020,1),predict(lm(MSRP~Year),newdata=new),col="red",lwd=4) # MSRP may need to be log transformed.

#Horsepower
plot(Engine.HP,MSRP, xlab="Horsepower",ylab="MSRP")
new<-data.frame(Engine.HP=seq(50,1010,1))
lines(seq(50,1010,1),predict(lm(MSRP~Engine.HP),newdata=new),col="red",lwd=4) # MSRP may need to be log Transformed to get a better pairing with Horsepower

#Number of Doors
plot(Number.of.Doors,MSRP, xlab="Number of Doors",ylab="MSRP")
new<-data.frame(Number.of.Doors=seq(1,10,1))
lines(seq(1,10,1),predict(lm(MSRP~Number.of.Doors),newdata=new),col="red",lwd=4) # Couple outliers but not needed for the model

#Highway MPG
plot(highway.MPG,MSRP, xlab="Highway Miles",ylab="MSRP")
new<-data.frame(highway.MPG=seq(0,1000,1))
lines(seq(0,1000,1),predict(lm(MSRP~highway.MPG),newdata=new),col="red",lwd=4)


#City MPG
plot(city.mpg,MSRP, xlab="City Miles",ylab="MSRP")
new<-data.frame(city.mpg=seq(0,1000,1))
lines(seq(0,1000,1),predict(lm(MSRP~city.mpg),newdata=new),col="red",lwd=4)

#Popularity
plot(Popularity,MSRP, xlab="Popularity",ylab="MSRP")
new<-data.frame(Popularity=seq(1,10000,1))
lines(seq(1,10000,1),predict(lm(Popularity~city.mpg),newdata=new),col="red",lwd=4)


```

```{r}

summary(Auto)

```


# Multicollinearity

```{r}

pairs (Auto[, -c(1, 2,4,5, 7,8, 10, 11, 12, 15)])

Auto %>% 
  select (MSRP, Year, Engine.HP, Number.of.Doors, highway.MPG, city.mpg) %>%
  ggpairs(mapping = aes())


```


